{% extends 'base.html' %}

{% block title %}
  {{ block.super }}
{% endblock %}

{% block breadcrumb %}
  <li class="breadcrumb-item"><a href="{% url 'home' %}">Conversations</a></li>
  <li class="breadcrumb-item"><a href="{% url 'class_wiki' %}"> Class Wiki </a> </li>
  <li class="breadcrumb-item active"> {{ class_wiki }} </li>

{% endblock %}

{% block content %}
  <div class="card-deck">


  <div class="card" style="border: 2px solid black; border-radius: 25px; margin-bottom: 2%; padding-bottom: 1.5%; padding-top: 1.5%; padding-left: 1.5%; padding-right: 1.5%; margin-right: 0%;">
  <h1> {{ class_wiki }} Wiki </h1>
  <p style="color: darkgrey; font-weight: 500; font-size: 15px; margin-top: 0%; margin-bottom: 0%;"> {{ class_wiki.courseName }} </p>
  <p style="color: darkgrey; font-weight: 500; font-size: 15px; margin-top: 0%; margin-bottom: 0%;"> Professor: {{ class_wiki.professor }} </p>
  <p style="color: darkgrey; font-weight: 500; font-size: 15px; margin-top: 0%; margin-bottom: 0%;"> Wiki started by: {{ class_wiki.starter }} </p>
  <p style="color: darkgrey; font-weight: 500; font-size: 15px; margin-top: 0%; margin-bottom: 0%;">
    Other contributors:
    {% if class_wiki.contributors.all|length == 0 %}
    None.
    {% endif %}

    {% if class_wiki.contributors.all|length == 1 %}
    {% for contributor in class_wiki.contributors.all %}
    {{ contributor }}
    {% endfor %}
    {% endif %}

    {% if class_wiki.contributors.all|length > 1 %}
    {% for contributor in class_wiki.contributors.all %}
      {{ contributor }}, &nbsp
    {% endfor %}
    {% endif %}
  </p>

  <p style="color: darkgrey; font-weight: 500; font-size: 15px; margin-top: 0%; margin-bottom: 0%;"> Followers: {{ class_wiki.followers.all|length }} </p>
  <p style="color: darkgrey; font-weight: 500; font-size: 15px; margin-top: 0%; margin-bottom: 0%;"> Views: {{ class_wiki.views }} </p>
  </div>

  <div class="card text-center" style="background: transparent; border: none; margin-bottom: 0%; padding-bottom: 0%; margin-right: 2.1%; margin-left: 2.1%; margin-top: 0%; ">
  <p style="margin-bottom: 0%; margin-top: 10%;">
  <a href="{% url 'new_class_wiki_content' class_wiki.pk %}", class="btn btn-primary btn-sm" style="margin-top: 3%; margin-bottom: 0%;"> <i class="fas fa-blog"></i> Post content </a>

  {% if user_is_a_follower == False %}
  <a href="{% url 'follow_class_wiki' class_wiki.pk %}", class="btn btn-success btn-sm" style="margin-top: 3%; margin-bottom: 0%;"> <i class="fas fa-satellite-dish"></i> Follow this wiki </a>
  {% endif %}

  {% if user_is_a_follower == True %}
  <a href="{% url 'unfollow_class_wiki' class_wiki.pk %}", class="btn btn-danger btn-sm" style="margin-top: 3%; margin-bottom: 0%;"> <i class="fas fa-dizzy"></i> Unfollow this wiki </a>
  {% endif %}
  </p>
  <p style="margin-bottom: 0%;">
  <a href="{% url 'see_class_wiki_followers' class_wiki.pk %}", class="btn btn-warning btn-sm" style="margin-top: 3%; margin-bottom: 0%;"> <i class="far fa-address-book"></i> See followers </a>

  {% if class_wiki_has_current_class == True %}
  <a href="{% url 'class_details' connected_class.pk %}", class="btn btn-info btn-sm" style="margin-top: 3%; margin-bottom: 0%;"> <i class="fas fa-directions"></i> Visit SP2021 class page </a>
  {% endif %}

  {% if class_wiki_has_current_class == False %}
  <a href="{% url 'attach_wiki_to_class' class_wiki.pk %}", class="btn btn-info btn-sm" style="margin-top: 3%; margin-bottom: 0%;"> <i class="fas fa-microchip"></i> Attach wiki to SP2021 class </a>
  {% endif %}

  </p>

  {% if class_wiki.is_reported_duplicate == True %}
      <a href="#", class="btn btn-danger btn-sm" style="margin-top: 3%; margin-bottom: 0%;" disabled> Already reported as duplicate! </a>
  {% endif %}

  {% if class_wiki.is_reported_duplicate == False %}
      <a href="{% url 'report_duplicate_wiki' class_wiki.pk %}", class="btn btn-danger btn-sm" style="margin-top: 3%; margin-bottom: 0%;"> <i class="fas fa-exclamation-circle"></i> Report as duplicate </a>
  {% endif %}

  {% if class_wiki_has_current_class == True %}
      <a href="{% url 'attach_wiki_to_class' class_wiki.pk %}", class="btn btn-danger btn-sm" style="margin-top: 3%; margin-bottom: 0%;"> <i class="fas fa-exclamation-circle"></i> Change attached class </a>
  {% endif %}




  </div>

  <div class="card text-center" style="border: 2px solid black; border-radius: 25px; margin-left: 25%; margin-right: 4%; margin-left: 0%; margin-bottom: 2%;">
    <h5 class="card-title" style="margin-top: 2%;">
      Wiki Conversation
    </h5>
    <div class="card-body">
    {% if topics|length == 0 %}
    There are no current topics of discussion.
    {% endif %}

    {% if topics|length > 0 %}
    {% for topic in topics %}
      {% if forloop.counter|divisibleby:'2' == True %}
      <a href="{% url 'class_wiki_topic_posts' class_wiki.pk topic.pk %}" class="btn btn-sm" style="background-color: rgba(150, 109, 207, 100); margin-top: 1%; margin-bottom: 1%; margin-left: 21%; margin-right: 30%;">
        <p style="color: black; font-size: 15px; weight: 300%; margin-top: 0%; margin-bottom: 0%;"> {{ topic }}</p>
        <p style="color: white; font-size: 10px; weight: 500%; margin-top: 0%; margin-bottom: 0%;"> {{ topic.created_at }}</p>
        <p style="color: white; font-size: 10px; weight: 500%; margin-top: 0%; margin-bottom: 0%;"> Created by: {{ topic.starter }}</p>
        <p style="color: white; font-size: 10px; weight: 500%; margin-top: 0%; margin-bottom: 0%;"> {{ topic.views }} views </p>
      </a>
      {% endif %}
      {% if forloop.counter|divisibleby:'2' == False %}
      <a href="{% url 'class_wiki_topic_posts' class_wiki.pk topic.pk %}" class="btn btn-success btn-sm" style="background-color: rgba(255, 102, 99, 100); margin-top: 1%; margin-bottom: 1%; margin-left: 21%; margin-right: 30%;">
        <p style="color: black; font-size: 15px; weight: 500%; margin-top: 0%; margin-bottom: 0%;"> {{ topic }}</p>
        <p style="color: white; font-size: 10px; weight: 500%; margin-top: 0%; margin-bottom: 0%;"> {{ topic.created_at }}</p>
        <p style="color: white; font-size: 10px; weight: 500%; margin-top: 0%; margin-bottom: 0%;"> Created by: {{ topic.starter }}</p>
        <p style="color: white; font-size: 10px; weight: 500%; margin-top: 0%; margin-bottom: 0%;"> {{ topic.views }} views </p>
      </a>
      {% endif %}
      {% endfor %}
      {% endif %}
      <a href="{% url 'class_wiki_topics' class_wiki.pk %}", class="btn btn-success btn-sm" style="margin-top: 5%; margin-bottom: 2%; margin-left: 20%; margin-right: 30%;">  post + see more topics </a>
    <p>
  </div>
  </div>

</div>

{% if class_wiki.content.all|length == 0 %}
<p> There is no content posted yet for this class wiki. </p>
{% endif %}
{% if class_wiki.content.all|length > 0 %}
<div class="row" style="margin-right: 0%; margin-top: 1%;">
  {% for content in class_wiki.content.all %}
  <div class="col-sm-4">
  <div class="card text-center">
    <div class="card-header" style="padding-top: .5%; padding-bottom: .5%">
      <h5> {{ content.subject }} </h5>
    </div>
    <div class="card-body" style="padding-top: .5%;">
      <p style="color: black; font-size: 15px; weight: 300%; margin-bottom: 0%; margin-top: 0%;"> Details: </p>
      <p style="color: darkgrey; font-size: 10px; weight: 300%; margin-bottom: 0%; margin-top: 0%;"> Created by {{ content.created_by }} </p>
      <p style="color: darkgrey; font-size: 10px; weight: 300%; margin-top: 0%; margin-bottom: 0%;"> Created on {{ content.created_at }} </p>
      <p style="color: black; font-size: 15px; weight: 300%; margin-top: 1%; margin-bottom: 0%;"> Description: </p>
      <p style="color: darkgrey; font-size: 10px; weight: 300%; margin-top: 0%; margin-bottom: 0%;"> {{ content.description }} </p>
      <a href="{% url 'see_class_wiki_content' class_wiki.pk content.pk %}", class="btn btn-primary btn-sm" style="margin-top: 2%; margin-bottom: 0%; padding-b"> See more </a>

    </div>
    </div>
    </div>
  {% endfor %}
</div>
</div>
{% endif %}


{% endblock %}
